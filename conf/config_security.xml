<?xml version="1.0" encoding="utf-8"?>
<configdata>
    <env>
        <REQUEST_SECURITY_LEVEL value="1" />
    </env>
    <hooks>
        <hook name="on_app_run" obj="\phpformsframework\libs\security\Buckler" method="antiVulnerabilityScanner" />
    </hooks>
    <badpath>
        <rule source="^/cache*"                         destination="404"       />
        <rule source="^/uploads*"                       destination="404"       />
        <rule source="^/vendor*"                        destination="404"       />
        <rule source="*/index*"                         destination="$1"        />
        <rule source="wp-login*"                        destination="401"       />
        <rule source="wp-*"                             destination="403"       />
        <rule source="*.shtml"                          destination="403"       />
        <rule source="[^a-z\-0-9/\+\.\_\\@]+"           destination="400"       />

        <rule source="^/autodiscover/*"                 destination="404"       />
    </badpath>
    <pages>
        <!-- Widgets -->
        <page path="/login" controller="phpformsframework\libs\security\widgets\Login">
            <header name="csrf"                                                 />

            <post name="identifier" required="true"     validator="username"    />
            <post name="password"   required="true"     validator="password"    />
            <post name="permanent"                      validator="bool"        />
        </page>
        <page path="/logout" controller="phpformsframework\libs\security\widgets\Logout">
            <header name="csrf"                                                 />
        </page>
        <page path="/activation" controller="phpformsframework\libs\security\widgets\Activation">
            <header name="csrf"                                                 />

            <post name="code"                           validator="totp"        />
            <post name="identifier"                     validator="email"       />
        </page>

        <page path="/recover/{action}" controller="phpformsframework\libs\security\widgets\Recover">
            <header name="csrf"                                                 />

            <get name="action"                          required="true"         />

            <post name="code"                           validator="totp"        />
            <post name="identifier"                     validator="string"      />
            <post name="value"                          validator="password"    />
        </page>

        <page path="/registration/{model}" controller="phpformsframework\libs\security\widgets\Registration">
            <header name="csrf"                                                 />

            <get name="model"                           />
            <get name="referral"                        />

            <post name="identifier"                     validator="username"    />
            <post name="password"                       validator="password"    />
            <post name="email"                          validator="email"       />
            <post name="tel"                            validator="tel"         />
            <post name="avatar"                                                 />

            <post name="code"                           validator="totp"        />
        </page>
        <page path="/otp" controller="phpformsframework\libs\security\widgets\Otp">
            <header name="csrf"                                                 />

            <post name="code"                           validator="totp"        />
        </page>
    </pages>

    <models>
        <model name="user" collection="access" table="users" mapclass="\phpformsframework\libs\security\UserData">
            <field name="uuid"              db="users.uuid"                         source="$uuid"                  fake="fdbba8ff-86a4-442f-a3c4-ac034210b7e9" />
            <field name="username"          db="users.username"                     source="$username"              fake="nobody" />
            <field name="email"             db="users.email"                        source="$email"                 fake="john.doe@nobody.it" />
            <field name="tel"               db="users.tel"                          source="$tel"                   fake="3498844546" />
            <field name="display_name"      db="users.username"                     source="$username"              fake="nobody" />
            <field name="avatar"            db="users.avatar"                       source="$avatar"                fake="noavatar" />
            <field name="status"            db="users.status"                       source="$status"                fake="1" />
            <field name="acl"               db="users.acl"                          source="$acl"                   fake="" />
        </model>
    </models>
</configdata>