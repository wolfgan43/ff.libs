<?xml version="1.0" encoding="utf-8"?>
<configdata>
    <env>
        <REQUEST_SECURITY_LEVEL value="1" />
    </env>
    <hooks>
        <hook name="on_app_run" obj="\phpformsframework\libs\security\Buckler" method="antiVulnerabilityScanner" />
    </hooks>
    <badpath>
        <rule source="^/cache*"                         destination="404"       />
        <rule source="^/uploads*"                       destination="404"       />
        <rule source="^/vendor*"                        destination="404"       />
        <rule source="*/index*"                         destination="$1"        />
        <rule source="wp-login*"                        destination="401"       />
        <rule source="wp-*"                             destination="403"       />
        <rule source="*.shtml"                          destination="403"       />
        <rule source="[^a-z\-0-9/\+\.\_\\@]+"           destination="400"       />

        <rule source="^/autodiscover/*"                 destination="404"       />
    </badpath>
    <pages>
        <!-- Widgets -->
        <page path="/login" controller="phpformsframework\libs\security\widgets\Login"                          csrf="true"     access="public">
            <post name="identifier" required="true"     validator="username"    />
            <post name="password"   required="true"     validator="password"    />
            <post name="permanent"                      validator="bool"        />
        </page>
        <page path="/logout" controller="phpformsframework\libs\security\widgets\Logout"                        csrf="true">
        </page>
        <page path="/activation" controller="phpformsframework\libs\security\widgets\Activation"                csrf="true"     access="public">
            <post name="code"                           validator="totp"        />
            <post name="identifier"                     validator="email"       />
        </page>

        <page path="/recover/{action}" controller="phpformsframework\libs\security\widgets\Recover"             csrf="true"     access="public">
            <get name="action"                          required="true"         />

            <post name="code"                           validator="totp"        />
            <post name="identifier"                     validator="string"      />
            <post name="value"                          validator="password"    />
        </page>

        <page path="/registration/{model}" controller="phpformsframework\libs\security\widgets\Registration"    csrf="true"     access="public">
            <get name="model"                           />
            <get name="referral"                        />

            <post name="identifier"                     validator="username"    />
            <post name="password"                       validator="password"    />
            <post name="email"                          validator="email"       />
            <post name="tel"                            validator="tel"         />
            <post name="avatar"                                                 />

            <post name="code"                           validator="totp"        />
        </page>
        <page path="/otp" controller="phpformsframework\libs\security\widgets\Otp"                              csrf="true">
            <post name="code"                           validator="totp"        />
        </page>
    </pages>

    <models>
        <model name="user" collection="access" table="users" mapclass="\phpformsframework\libs\security\UserData">
            <field name="uuid"              db="uuid"                         request="$uuid"                  mock="fdbba8ff-86a4-442f-a3c4-ac034210b7e9" />
            <field name="username"          db="username"                     request="$username"              mock="nobody" />
            <field name="email"             db="email"                        request="$email"                 mock="john.doe@nobody.it" />
            <field name="tel"               db="tel"                          request="$tel"                   mock="3498844546" />
            <field name="display_name"      db="display_name"                 request="$display_name"          mock="John Doe" />
            <field name="avatar"            db="avatar"                       request="$avatar"                mock="noavatar" />
            <field name="status"            db="status"                       request="$status"                mock="1" />
            <field name="acl"               db="acl"                          request="$acl"                   mock="" />
        </model>
    </models>
</configdata>